# Smart Loop Capture Update - Auto-Split –Ω–∞ —Å–æ–±—ã—Ç–∏—è

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ Capture item —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ S/L/E/R —Å–æ–∑–¥–∞–≤–∞–ª—Å—è **–æ–¥–∏–Ω event**, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —Ä–∞–∑–¥–µ–ª—è–ª—Å—è –Ω–∞ —Å–µ–∫—Ü–∏–∏. –ü—Ä–∏ —Ç—Ä–∏–≥–≥–µ—Ä–µ Smart Loop –≤—Å—Ç–∞–≤–ª—è–ª—Å—è –≤–µ—Å—å item —Ü–µ–ª–∏–∫–æ–º, –±–µ–∑ –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏—è.

### –†–µ—à–µ–Ω–∏–µ
–¢–µ–ø–µ—Ä—å –ø—Ä–∏ Capture item —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–¥–µ–ª—è–µ—Ç—Å—è** –Ω–∞ 3 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è:

1. **START** - —Å–µ–∫—Ü–∏—è –æ—Ç S –¥–æ L (intro)
2. **LOOP** - —Å–µ–∫—Ü–∏—è –æ—Ç L –¥–æ E (–∑–∞—Ü–∏–∫–ª–∏–≤–∞–µ–º–∞—è —á–∞—Å—Ç—å)
3. **RELEASE** - —Å–µ–∫—Ü–∏—è –æ—Ç E –¥–æ R (–∫–æ–Ω—Ü–æ–≤–∫–∞)

---

## üÜï –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏ Capture

**–î–æ (—Å—Ç–∞—Ä–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ):**
```
Capture item —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ ‚Üí —Å–æ–∑–¥–∞–µ—Ç—Å—è 1 event ‚Üí –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤–µ—Å—å item
```

**–°–µ–π—á–∞—Å (–Ω–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ):**
```
Capture item —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ ‚Üí —Å–æ–∑–¥–∞—é—Ç—Å—è 3 —Å–æ–±—ã—Ç–∏—è:
  - START (S‚ÜíL)
  - LOOP (L‚ÜíE)
  - RELEASE (E‚ÜíR)
```

### 2. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Razor Edit

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ **Razor Edit**:
1. –°–æ–∑–¥–∞–π—Ç–µ Razor Edit area –Ω–∞ —Ç—Ä–µ–∫–µ
2. –ù–∞–∂–º–∏—Ç–µ **CAPTURE (+)** –≤ ReaSFX
3. –°–æ–±—ã—Ç–∏—è –∏–∑ Razor area –±—É–¥—É—Ç –∑–∞—Ö–≤–∞—á–µ–Ω—ã

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** Razor Edit –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ü–ï–†–í–´–ú, –∑–∞—Ç–µ–º selected items.

---

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –¢–µ—Å—Ç 1: –ë–∞–∑–æ–≤—ã–π Smart Loop —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º

#### –®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ item —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏
1. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ª—é–±–æ–π audio —Ñ–∞–π–ª –≤ REAPER
2. –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ ‚Üí **Take markers**
3. –î–æ–±–∞–≤—å—Ç–µ –º–∏–Ω–∏–º—É–º:
   - **L** = 1.000 (–Ω–∞—á–∞–ª–æ loop)
   - **E** = 2.000 (–∫–æ–Ω–µ—Ü loop)
4. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:
   - **S** = 0.500 (–Ω–∞—á–∞–ª–æ start —Å–µ–∫—Ü–∏–∏)
   - **R** = 2.500 (–∫–æ–Ω–µ—Ü release)

**–ü—Ä–∏–º–µ—Ä:**
```
Audio: |--[S=0.5]--[L=1.0]=====[E=2.0]--[R=2.5]--|
       Intro       Loop body    Release
```

#### –®–∞–≥ 2: Capture –≤ ReaSFX
1. –í—ã–¥–µ–ª–∏—Ç–µ item
2. –û—Ç–∫—Ä–æ–π—Ç–µ ReaSFX
3. –í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞–≤–∏—à—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, 60)
4. –í—ã–±–µ—Ä–∏—Ç–µ set (–Ω–∞–ø—Ä–∏–º–µ—Ä, S1)
5. –ù–∞–∂–º–∏—Ç–µ **CAPTURE (+)**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
–í —Å–ø–∏—Å–∫–µ —Å–æ–±—ã—Ç–∏–π –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è **3 —Å–æ–±—ã—Ç–∏—è**:
- **START** - intro —Å–µ–∫—Ü–∏—è
- **LOOP** - –∑–∞—Ü–∏–∫–ª–∏–≤–∞–µ–º–∞—è —Å–µ–∫—Ü–∏—è
- **RELEASE** - –∫–æ–Ω—Ü–æ–≤–∫–∞

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ GUI:**
```
[START]  ‚ñì  M P:100% V:+0.0 X
[LOOP]   ‚ñì  M P:100% V:+0.0 X
[RELEASE] ‚ñì  M P:100% V:+0.0 X
```

#### –®–∞–≥ 3: –°–æ–∑–¥–∞–π—Ç–µ Time Selection
1. –í—ã–¥–µ–ª–∏—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω –Ω–∞ timeline (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10 —Å–µ–∫—É–Ω–¥)
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Time Selection –∞–∫—Ç–∏–≤–Ω–∞

#### –®–∞–≥ 4: –¢—Ä–∏–≥–≥–µ—Ä Smart Loop
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ **Trigger Mode = Smart Loop**
2. –ù–∞–∂–º–∏—Ç–µ –∫–ª–∞–≤–∏—à—É **K**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
–ù–∞ timeline –ø–æ—è–≤—è—Ç—Å—è items:
- **1 √ó START** - –≤ –Ω–∞—á–∞–ª–µ Time Selection (—Å snap –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º)
- **N √ó LOOP** - –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Ü–∏–∫–ª—ã
- **1 √ó RELEASE** - –≤ –∫–æ–Ω—Ü–µ

**Status Log:**
```
"Using time selection: 0.00 to 10.00"
"Phase 1 START: len=0.500, offset=0.500"
"Phase 2 LOOP: len=1.000, offset=1.000, remaining=9.500"
"Phase 3 RELEASE: len=0.500, offset=2.000"
"SmartLoop complete: 10.00s filled, 9 loops"
```

---

### –¢–µ—Å—Ç 2: Razor Edit Capture

#### –®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ Razor Edit
1. –í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç **Razor Edit** (–∫–ª–∞–≤–∏—à–∞ `6` –≤ REAPER)
2. –í—ã–¥–µ–ª–∏—Ç–µ –æ–±–ª–∞—Å—Ç—å –Ω–∞ —Ç—Ä–µ–∫–µ —Å audio item
3. Razor area –¥–æ–ª–∂–Ω–∞ –ø–æ–¥—Å–≤–µ—Ç–∏—Ç—å—Å—è

#### –®–∞–≥ 2: Capture —á–µ—Ä–µ–∑ Razor Edit
1. –û—Ç–∫—Ä–æ–π—Ç–µ ReaSFX (–Ω–µ —É–±–∏—Ä–∞–π—Ç–µ Razor Edit!)
2. –í—ã–±–µ—Ä–∏—Ç–µ set
3. –ù–∞–∂–º–∏—Ç–µ **CAPTURE (+)**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
Status Log: "Captured 1 events from Razor Edit"
```

---

### –¢–µ—Å—Ç 3: Item –±–µ–∑ –º–∞—Ä–∫–µ—Ä–æ–≤ (–æ–±—ã—á–Ω—ã–π Capture)

#### –®–∞–≥ 1: Capture –æ–±—ã—á–Ω–æ–≥–æ item
1. –í—ã–¥–µ–ª–∏—Ç–µ item –ë–ï–ó take markers
2. –ù–∞–∂–º–∏—Ç–µ **CAPTURE (+)**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
–°–æ–∑–¥–∞–µ—Ç—Å—è **1 –æ–±—ã—á–Ω—ã–π event** (–±–µ–∑ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è)
```
E01  M P:100% V:+0.0 X
```

#### –®–∞–≥ 2: –¢—Ä–∏–≥–≥–µ—Ä –∫–∞–∫ –æ–±—ã—á–Ω–æ
- **One Shot** - –≤—Å—Ç–∞–≤–ª—è–µ—Ç item —Ü–µ–ª–∏–∫–æ–º
- **Sequencer** - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ

---

## üìä –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

#### 1. –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è `CaptureRazorEdit()` (—Å—Ç—Ä–æ–∫–∏ 121-172)
–°–∫–∞–Ω–∏—Ä—É–µ—Ç –≤—Å–µ —Ç—Ä–µ–∫–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ Razor Edit areas –∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç items.

**–§–æ—Ä–º–∞—Ç Razor Edit:**
```lua
"start1 end1" "start2 end2" ...
```

#### 2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `CaptureToActiveSet()` (—Å—Ç—Ä–æ–∫–∏ 174-336)

**–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:**
```lua
if item.smart and item.smart.L and item.smart.E then
    -- Split into 3 events:

    -- Event 1: START (S ‚Üí L)
    create_event({
        section_type = "START",
        slice_offset = S,
        slice_length = L - S
    })

    -- Event 2: LOOP (L ‚Üí E)
    create_event({
        section_type = "LOOP",
        slice_offset = L,
        slice_length = E - L
    })

    -- Event 3: RELEASE (E ‚Üí R)
    if R then
        create_event({
            section_type = "RELEASE",
            slice_offset = E,
            slice_length = R - E
        })
    end
else
    -- Regular capture (no split)
    create_single_event()
end
```

#### 3. –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è `BuildSmartLoopFromEvents()` (—Å—Ç—Ä–æ–∫–∏ 540-633)

**–ü—Ä–∏–Ω–∏–º–∞–µ—Ç:**
- `start_evt` - START —Å–æ–±—ã—Ç–∏–µ (–º–æ–∂–µ—Ç –±—ã—Ç—å nil)
- `loop_evt` - LOOP —Å–æ–±—ã—Ç–∏–µ (**–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ**)
- `release_evt` - RELEASE —Å–æ–±—ã—Ç–∏–µ (–º–æ–∂–µ—Ç –±—ã—Ç—å nil)
- `fill_start`, `fill_end` - Time Selection –¥–∏–∞–ø–∞–∑–æ–Ω

**–í—ã–ø–æ–ª–Ω—è–µ—Ç:**
1. Insert START (1 —Ä–∞–∑) —Å snap –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º
2. Insert LOOP (—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏) —Å crossfade
3. Insert RELEASE (1 —Ä–∞–∑) —Å fadeout

#### 4. –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `SmartLoopRelease()` (—Å—Ç—Ä–æ–∫–∏ 758-819)

**–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:**
```lua
-- –ò—â–µ–º —Å–æ–±—ã—Ç–∏—è –≤ —Å–µ—Ç–µ –ø–æ —Ç–∏–ø—É
for _, evt in ipairs(set.events) do
    if evt.section_type == "START" then start_evt = evt end
    if evt.section_type == "LOOP" then loop_evt = evt end
    if evt.section_type == "RELEASE" then release_evt = evt end
end

-- –í—ã–∑—ã–≤–∞–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
Core.BuildSmartLoopFromEvents(start_evt, loop_evt, release_evt, ...)
```

#### 5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ GUI (—Å—Ç—Ä–æ–∫–∏ 163-173)

**–ù–æ–≤–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:**
```lua
if evt.section_type then
    lbl = evt.section_type  -- "START", "LOOP", "RELEASE"
else
    lbl = "E01" .. (evt.is_smart and " (S)" or "")
end
```

---

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ —Å–æ–∑–¥–∞—é—Ç—Å—è 3 —Å–æ–±—ã—Ç–∏—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –ú–∞—Ä–∫–µ—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–∑–≤–∞–Ω—ã?**
```
–î–æ–ª–∂–Ω—ã –±—ã—Ç—å: L, E (–º–∏–Ω–∏–º—É–º)
–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: S, R
–ù–ï: l, e, s, r (—Ä–µ–≥–∏—Å—Ç—Ä –≤–∞–∂–µ–Ω!)
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –ú–∞—Ä–∫–µ—Ä—ã –≤ take, –Ω–µ –≤ timeline?**
- –ú–∞—Ä–∫–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–≤ take** (item), –Ω–µ –≤ project timeline

**–ü—Ä–æ–≤–µ—Ä–∫–∞ 3: Status Log**
–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
"Smart item: S=0.500 L=1.000 E=2.000 R=2.500"
"Captured 3 events (3 smart splits)"
```

### –ü—Ä–æ–±–ª–µ–º–∞: Razor Edit –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
1. Razor Edit area –≤–∏–¥–Ω–∞ –Ω–∞ —Ç—Ä–µ–∫–µ?
2. Area –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç—Å—è —Å item?
3. Status log –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
   ```
   "Captured N events from Razor Edit"
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: Smart Loop –Ω–µ –∑–∞–ø–æ–ª–Ω—è–µ—Ç Time Selection

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
1. –í GUI –µ—Å—Ç—å —Å–æ–±—ã—Ç–∏—è START, LOOP, RELEASE?
2. Time Selection —Å–æ–∑–¥–∞–Ω –ø–µ—Ä–µ–¥ –Ω–∞–∂–∞—Ç–∏–µ–º K?
3. Trigger Mode = Smart Loop?
4. Status log –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
   ```
   "Using time selection: X.XX to Y.YY"
   "Phase 1 START: ..."
   "Phase 2 LOOP: ..."
   ```

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —á–µ–∫–ª–∏—Å—Ç

–ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å:

- [ ] ‚úÖ Capture item —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ ‚Üí —Å–æ–∑–¥–∞–µ—Ç—Å—è 3 —Å–æ–±—ã—Ç–∏—è (START, LOOP, RELEASE)
- [ ] ‚úÖ GUI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è —Å–µ–∫—Ü–∏–π –≤–º–µ—Å—Ç–æ E01/E02/E03
- [ ] ‚úÖ Capture item –ë–ï–ó –º–∞—Ä–∫–µ—Ä–æ–≤ ‚Üí —Å–æ–∑–¥–∞–µ—Ç—Å—è 1 –æ–±—ã—á–Ω—ã–π event
- [ ] ‚úÖ Razor Edit capture —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] ‚úÖ Smart Loop –∑–∞–ø–æ–ª–Ω—è–µ—Ç Time Selection –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
  - [ ] START –≤—Å—Ç–∞–≤–ª–µ–Ω 1 —Ä–∞–∑ —Å snap –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º
  - [ ] LOOP –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è N —Ä–∞–∑
  - [ ] RELEASE –≤—Å—Ç–∞–≤–ª–µ–Ω 1 —Ä–∞–∑ –≤ –∫–æ–Ω—Ü–µ
- [ ] ‚úÖ Crossfade –º–µ–∂–¥—É loops —Å–ª—ã—à–µ–Ω
- [ ] ‚úÖ Status log –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ï—Å–ª–∏ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **GUI —É–ª—É—á—à–µ–Ω–∏—è:**
   - –í–∏–∑—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ START/LOOP/RELEASE (—Ä–∞–∑–Ω—ã–µ —Ü–≤–µ—Ç–∞)
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–ª–∏–Ω—É –∫–∞–∂–¥–æ–π —Å–µ–∫—Ü–∏–∏

2. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã Smart Loop:**
   - GUI –∫–æ–Ω—Ç—Ä–æ–ª—ã –¥–ª—è crossfade
   - Sync mode (free/tempo/grid)

3. **Multi-item Smart Loop:**
   - –ó–∞—Ö–≤–∞—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö items —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏
   - –†–∞–∑–Ω—ã–µ loop points –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ—è

---

**–í–µ—Ä—Å–∏—è:** 2.0.2
**–î–∞—Ç–∞:** 2026-01-21
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
