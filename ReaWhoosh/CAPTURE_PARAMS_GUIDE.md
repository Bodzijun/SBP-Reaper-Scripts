# Захват параметров из эффекта (Capture FX Parameters)

## Описание функции (v3.2+)

Функция **Capture FX** позволяет загружать все текущие параметры из активного эффекта `sbp_WhooshEngine` обратно в интерфейс ReaWhoosh. Это полезно, когда вы:

- Закрыли интерфейс и вернулись к редактированию
- Хотите восстановить состояние всех параметров
- Работаете с существующими проектами где уже были установлены параметры

## Способы использования

### 1. Ручной захват параметров

Нажмите кнопку **"Capture FX"** в главном интерфейсе (рядом с "Toggle Envs" и "Randomize")

- Кнопка синего цвета
- При наведении показывает подсказку "Load parameters from active FX effect"
- Загружает все параметры из эффекта в интерфейс

### 2. Автоматический захват при открытии

В меню **Options → Parameter Loading** есть опция:

**"Auto-load FX params on startup"**

- **Включено** (по умолчанию): При каждом открытии скрипта автоматически загружает параметры с эффекта
- **Выключено**: Параметры загружаются из последнего сохраненного пресета

## Загружаемые параметры

Функция `CaptureParamsFromFX()` читает и восстанавливает:

### Основные параметры:
- Режим вывода (Stereo/Surround)
- Режим тона (Pitch/Freq/Audio)
- Главный уровень (Master Volume)

### Генераторы:
- **Noise**: тип шума, тон/окрас
- **Oscillator**: форма волны, PWM, отстройка, драйв, сдвиг октавы, тон
- **Chua**: скорость, форма, тембр, альфа (хаос)
- **Sub**: частота, сатурация

### Эффекты:
- Saturation Drive
- Bitcrusher Mix & Rate
- Punch Amount
- Ring Mod Metal Mix
- Flanger Mix & Feedback
- Doubler Spread & Time
- Reverb: Damp, Tail, Size

### Миксер:
- Trim уровни для каждого генератора (Noise, Osc, Chua, Ext)
- Sub Volume
- Master Gain

### Другие:
- Chopper Shape

## Примеры использования

### Сценарий 1: Продолжение работы
```
1. Открыли проект с уже настроенным эффектом
2. Запустили ReaWhoosh.lua
3. Параметры автоматически загружены (если опция включена)
4. Можете сразу редактировать пады и огибающие
```

### Сценарий 2: Восстановление после закрытия
```
1. Работали с параметрами, закрыли интерфейс
2. Позже вернулись к редактированию
3. Нажимаете "Capture FX"
4. Все параметры восстановлены в интерфейсе
```

### Сценарий 3: Импорт параметров из другого проекта
```
1. В одном проекте открыли эффект со своими параметрами
2. Нажимаете "Capture FX" чтобы загрузить их
3. Сохраняете как Preset (кнопка "+")
4. Теперь этот Preset доступен во всех проектах
```

## Технические детали

### Индексы параметров (IDX table)
Функция использует таблицу `IDX` для отображения параметров:
- Слайдеры 1-49 → параметры FX 0-48
- Слайдеры 50-53 → параметры FX 49-52

### Безопасность
- Если трек не найден → показывает ошибку
- Если эффект не найден → показывает ошибку
- Все значения проверены на диапазоны

### Производительность
- Операция выполняется один раз при загрузке (если автозагрузка включена)
- Ручной захват выполняется мгновенно
- Не блокирует интерфейс

## Связанные функции

- `SaveSettings()` - сохраняет флаг `auto_load_fx`
- `LoadSettings()` - загружает флаг при старте
- `ValidateConfig()` - проверяет корректность параметров

## Версия

Добавлено в: **v3.2**
